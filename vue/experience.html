<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue | ğŸŒ ğŸ¤£ ä»é›¶å¼€å§‹çš„å‰ç«¯å¼‚ä¸–ç•Œ~</title>
    <meta name="description" content="a frontend note book">
    
    
    <link rel="preload" href="/notebook/assets/css/0.styles.3ed308cc.css" as="style"><link rel="preload" href="/notebook/assets/js/app.ba99c14d.js" as="script"><link rel="preload" href="/notebook/assets/js/2.35fbb34e.js" as="script"><link rel="preload" href="/notebook/assets/js/28.d12f3f2d.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.803fbc69.js"><link rel="prefetch" href="/notebook/assets/js/11.558959fa.js"><link rel="prefetch" href="/notebook/assets/js/12.8013364d.js"><link rel="prefetch" href="/notebook/assets/js/13.fc53b13d.js"><link rel="prefetch" href="/notebook/assets/js/14.082aff3a.js"><link rel="prefetch" href="/notebook/assets/js/15.53308a1f.js"><link rel="prefetch" href="/notebook/assets/js/16.49c94e82.js"><link rel="prefetch" href="/notebook/assets/js/17.61425485.js"><link rel="prefetch" href="/notebook/assets/js/18.93c2fdd3.js"><link rel="prefetch" href="/notebook/assets/js/19.653c9e67.js"><link rel="prefetch" href="/notebook/assets/js/20.7ba0578a.js"><link rel="prefetch" href="/notebook/assets/js/21.9149643e.js"><link rel="prefetch" href="/notebook/assets/js/22.71ccb4f2.js"><link rel="prefetch" href="/notebook/assets/js/23.36b1bbbc.js"><link rel="prefetch" href="/notebook/assets/js/24.a3da3af9.js"><link rel="prefetch" href="/notebook/assets/js/25.440868b0.js"><link rel="prefetch" href="/notebook/assets/js/26.f8aab1c5.js"><link rel="prefetch" href="/notebook/assets/js/27.d8c93985.js"><link rel="prefetch" href="/notebook/assets/js/29.a35f38f5.js"><link rel="prefetch" href="/notebook/assets/js/3.2b640303.js"><link rel="prefetch" href="/notebook/assets/js/4.b71b9750.js"><link rel="prefetch" href="/notebook/assets/js/5.e39810fd.js"><link rel="prefetch" href="/notebook/assets/js/6.49423eaa.js"><link rel="prefetch" href="/notebook/assets/js/7.523412aa.js"><link rel="prefetch" href="/notebook/assets/js/8.adb59610.js"><link rel="prefetch" href="/notebook/assets/js/9.d9c2e66b.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.3ed308cc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><!----> <span class="site-name">ğŸŒ ğŸ¤£ ä»é›¶å¼€å§‹çš„å‰ç«¯å¼‚ä¸–ç•Œ~</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notebook/html/block.html" class="nav-link">HTML</a></div><div class="nav-item"><a href="/notebook/css/layout/css.html" class="nav-link">CSS</a></div><div class="nav-item"><a href="/notebook/js/javascript.html" class="nav-link">JS</a></div><div class="nav-item"><a href="/notebook/vue/experience.html" class="nav-link router-link-exact-active router-link-active">VUE</a></div><div class="nav-item"><a href="/notebook/node/WhatIsNode.js.html" class="nav-link">NODE</a></div><div class="nav-item"><a href="/notebook/http/http.html" class="nav-link">HTTP</a></div><div class="nav-item"><a href="/notebook/eventLoop.html" class="nav-link">EventLoop</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notebook/html/block.html" class="nav-link">HTML</a></div><div class="nav-item"><a href="/notebook/css/layout/css.html" class="nav-link">CSS</a></div><div class="nav-item"><a href="/notebook/js/javascript.html" class="nav-link">JS</a></div><div class="nav-item"><a href="/notebook/vue/experience.html" class="nav-link router-link-exact-active router-link-active">VUE</a></div><div class="nav-item"><a href="/notebook/node/WhatIsNode.js.html" class="nav-link">NODE</a></div><div class="nav-item"><a href="/notebook/http/http.html" class="nav-link">HTTP</a></div><div class="nav-item"><a href="/notebook/eventLoop.html" class="nav-link">EventLoop</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Html</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notebook/html/block.html" class="sidebar-link">å…³äºå—çº§å…ƒç´ </a></li><li><a href="/notebook/html/inline.html" class="sidebar-link">å…³äºè¡Œå†…å…ƒç´ </a></li><li><a href="/notebook/html/inlineblock.html" class="sidebar-link">è¡Œå†…å—çº§å…ƒç´ </a></li><li><a href="/notebook/html/charactor.html" class="sidebar-link">å®ä½“å­—ç¬¦</a></li><li><a href="/notebook/html/Emmet.html" class="sidebar-link">Emmet</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/notebook/vue/experience.html" class="active sidebar-link">Vue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/vue/experience.html#vueçš„ä¸€äº›é¡¹ç›®ç»éªŒ" class="sidebar-link">vueçš„ä¸€äº›é¡¹ç›®ç»éªŒ</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/notebook/regExp.html" class="sidebar-link">æ­£åˆ™è¡¨è¾¾å¼</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Http</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/notebook/eventLoop.html" class="sidebar-link">æµè§ˆå™¨äº‹ä»¶å¾ªç¯(Event Loop)</a></li><li><a href="/notebook/article.html" class="sidebar-link">ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</a></li><li><a href="/notebook/unresolved.html" class="sidebar-link">æœªå®Œå…¨è§£å†³çš„éœ€æ±‚</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue"><a href="#vue" aria-hidden="true" class="header-anchor">#</a> Vue</h1> <h2 id="vueçš„ä¸€äº›é¡¹ç›®ç»éªŒ"><a href="#vueçš„ä¸€äº›é¡¹ç›®ç»éªŒ" aria-hidden="true" class="header-anchor">#</a> vueçš„ä¸€äº›é¡¹ç›®ç»éªŒ</h2> <ol><li>ä»¥vue-cli3ä¸ºä¾‹ï¼Œvueæ‰“åŒ…éœ€è¦åœ¨vue.config.jsè®¾ç½® <code>publicPath</code> å±æ€§</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        publicPath<span class="token punctuation">:</span> <span class="token string">'./'</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>å‰ååˆ†ç¦»å¼€å‘æ—¶ï¼Œéœ€è¦è¿›è¡Œè·¨åŸŸ, å¯åœ¨vue.config.jsè®¾ç½® <code>devServer</code> å±æ€§</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            port<span class="token punctuation">:</span> <span class="token string">'8080'</span><span class="token punctuation">,</span>
            host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
            https<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            open<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token comment">// ä¸»è¦è®¾ç½®proxyå±æ€§</span>
            proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    target<span class="token punctuation">:</span> <span class="token string">'http://127.0.0.1:8088'</span><span class="token punctuation">,</span>
                    pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">'^/api'</span><span class="token punctuation">:</span> <span class="token string">''</span> <span class="token comment">// å­åŸŸå</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ä¹‹åå°±å¯ä»¥ä½¿ç”¨ <code>/api</code> ä½œä¸ºåŸŸåæ‹¼æ¥urlè¯·æ±‚åç«¯ï¼Œwebpackåˆ™ä½¿ç”¨ <code>http-proxy-middleware</code> è¿™ä¸ªä¸­é—´ä»¶æ¥è¿›è¡Œæ­£æƒ³ä»£ç†è·¨åŸŸã€‚</p> <ol start="3"><li>å…³äºæ¥å£ç®¡ç†ï¼Œvueå®˜æ–¹æ¨èä½¿ç”¨<a href="https://www.kancloud.cn/yunye/axios/234845" target="_blank" rel="noopener noreferrer">axios<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <ul><li><a href="https://juejin.im/post/5b55c118f265da0f6f1aa354" target="_blank" rel="noopener noreferrer">vueä¸­Axiosçš„å°è£…å’ŒAPIæ¥å£çš„ç®¡ç†<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ol start="4"><li>å…³äºç”¨vueå†™åå°ç®¡ç†</li></ol> <ul><li><a href="https://juejin.im/post/59097cd7a22b9d0065fb61d2" target="_blank" rel="noopener noreferrer">æ‰‹æ‘¸æ‰‹ç³»åˆ—<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ol start="5"><li>ä½¿ç”¨vueå†™çš„ç½‘ç«™urlå¾€å¾€éƒ½ä¼šå¸¦ç€ <code>#</code> , å¦‚æœä¸å–œæ¬¢è¿™æ ·çš„urlå¯ä»¥ä½¿ç”¨routerçš„ <code>history</code> æ¨¡å¼ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä¸‹å‡ ç‚¹</li></ol> <ul><li>routerä½¿ç”¨historyæ¨¡å¼ï¼Œè·¯ç”±ä¸èƒ½ä½¿ç”¨æ‡’åŠ è½½ï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸è·³è½¬é¡µé¢</li> <li>routerä½¿ç”¨historyæ¨¡å¼ï¼Œ <code>publicPath</code> å¿…é¡»è®¾ä¸ºæ ¹ç›®å½•(/)ï¼Œå¦åˆ™å›¾ç‰‡ç­‰é™æ€èµ„æºå°±æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚</li></ul> <p>åœ¨æœåŠ¡å™¨ä¸Šéœ€è¦è·‘åœ¨ä½¿ç”¨ <code>connect-history-api-fallback</code> ä¸­é—´ä»¶çš„nodeç¯å¢ƒï¼Œå…·ä½“ä¾‹å­ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'connect-history-api-fallback'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">8090</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hostName <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
    <span class="token function">history</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// è¦†ç›–Acceptsï¼Œæ›´æ”¹è¯·æ±‚çš„dataTypeé…ç½®</span>
        htmlAcceptHeaders<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'text/html'</span><span class="token punctuation">,</span> <span class="token string">'application/xhtml+xml'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        verbose<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// æ‰“å¼€æ—¥å¿—</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> segments <span class="token operator">=</span> __dirname<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\/config/</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä»£ç†é™æ€èµ„æºçš„è¯·æ±‚ã€‚ä¾‹å¦‚cssã€jsã€å›¾ç‰‡ç­‰ã€‚</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>segments<span class="token punctuation">,</span> <span class="token string">'client'</span><span class="token punctuation">,</span> <span class="token string">'project'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> html <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>segments<span class="token punctuation">,</span> <span class="token string">'client'</span><span class="token punctuation">,</span> <span class="token string">'project'</span><span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å› ä¸ºvueæ˜¯å•é¡µé¢åº”ç”¨ï¼Œç¡®ä¿ç”¨æˆ·åˆ·æ–°å’Œè¾“å…¥åœ°å€éƒ½æ˜¯è·³è½¬åˆ°index.html</span>
server<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> hostName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æœåŠ¡è¿è¡Œåœ¨http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hostName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>6.routerçš„ç¼–ç¨‹å¼å¯¼èˆªä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼æºå¸¦å‚æ•°è·³è½¬ï¼Œé€šè¿‡ï¼š</p> <ul><li><code>router.push({ name: '', params: {} });</code></li> <li><code>router.push({ path: '', query: {} });</code></li></ul> <p>ä¸¤ç§æ–¹å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä½¿ç”¨ <code>query</code> å¸¦å‚è·³è½¬ä¼šä»¥? çš„å½¢å¼å†™åœ¨urlä¸Šï¼Œé¡µé¢åˆ·æ–°æ—¶ä¸ä¼šæ‰å‚æ•°ï¼Œè€Œä½¿ç”¨ <code>params</code> å¸¦å‚è·³è½¬ä¸ä¼šå‡ºç°åœ¨urlä¸Šï¼Œå…·æœ‰éšè”½æ€§ï¼Œä½†æ˜¯åˆ·æ–°æ—¶ä¼šæ‰å‚æ•°ï¼Œæ‰€ä»¥æƒ³äº†ä¸€ä¸ªä¸¤å…¨å…¶ç¾çš„åŠæ³•ï¼Œ
ä½¿ç”¨ <code>params</code> ä¼ å‚ï¼Œé€šè¿‡ <code>router.beforeEach</code> æŠŠå‚æ•°å­˜åˆ°sessionStorageï¼Œå†é€šè¿‡ <code>router.afterEach</code> ï¼ŒæŠŠå‚æ•°å–å‡ºï¼Œå…·ä½“å®ç°ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// æŠŠparamså‚æ•°ç¼“å­˜èµ·æ¥</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'argments'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">(</span>routeParams<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'argments'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                routeParams<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">deal</span><span class="token punctuation">(</span><span class="token parameter">toRoute<span class="token punctuation">,</span> fromRoute</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'from'</span><span class="token punctuation">,</span> fromRoute<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'now'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'now'</span><span class="token punctuation">,</span> toRoute<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'now'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> toRoute<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fromRoute<span class="token punctuation">.</span>name <span class="token operator">&amp;&amp;</span>
                fromRoute<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'login'</span> <span class="token operator">&amp;&amp;</span>
                toRoute<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'login'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>toRoute<span class="token punctuation">.</span>params<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'now'</span><span class="token punctuation">,</span> toRoute<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨router.js</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å­˜å‚¨params</span>
    collector<span class="token punctuation">.</span><span class="token function">deal</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å–å‡ºparams</span>
    collector<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><ol start="7"><li><p>é€šè¿‡å¯¼èˆªå®ˆå«å¯ä»¥æ§åˆ¶é¡µé¢çš„è®¿é—®æƒé™ï¼Œå¦‚æœä½¿ç”¨ <code>path</code> è¿›è¡Œé€»è¾‘åˆ¤æ–­æ—¶ï¼Œæœ€å¥½å¯¹ <code>path</code> è¿›è¡Œå¤§å°å†™å­—æ¯è½¬æ¢å†åˆ¤æ–­ï¼Œå¯¼èˆªè·¯ç”±è¿”å›çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„åœ°å€ï¼Œä¸èƒ½ä¿¡ä»»ç”¨æˆ·è¾“å…¥çš„ä¸œè¥¿ã€‚</p></li> <li><p>åç«¯åŠ¨æ€æ§åˆ¶é¡µé¢æƒé™ï¼Œä¾§è¾¹æ æ§åˆ¶æ•´ä¸ªç½‘ç«™çš„é¡µé¢è·¯ç”±ï¼Œé€šè¿‡ <code>meta</code> ä¸Šçš„ <code>isSidebarItem</code> å±æ€§éšè—ä¾§è¾¹æ ä¸Šè¯¦æƒ…ã€ç¼–è¾‘é¡µç­‰å…¥å£</p></li></ol> <ul><li><code>formatRoutes</code> é€’å½’æ ¼å¼åŒ–åç«¯è·¯ç”±ä¸ºå‰ç«¯è·¯ç”±</li> <li><code>findRedirectPath</code> é€’å½’æ‰¾é¦–é¡µè·¯ç”±è·¯å¾„(å³ä¾§è¾¹æ ç¬¬ä¸€ä¸ªçš„é¡µé¢)</li> <li><code>assembleRoutes</code> ç»„è£…æ‰€æœ‰è·¯ç”± å¹¶æŒ‚è½½å®Œæ•´çš„è·¯ç”±</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 *
 * é€’å½’æ ¼å¼åŒ–åç«¯è·¯ç”±ä¸ºå‰ç«¯è·¯ç”±
 * @param {Array} routes
 * @returns
 */</span>
<span class="token keyword">function</span> <span class="token function">formatRoutes</span><span class="token punctuation">(</span><span class="token parameter">routes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">route</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> _route <span class="token operator">=</span> <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> route<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> route<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            component<span class="token punctuation">:</span> <span class="token function">getComponent</span><span class="token punctuation">(</span>
                route<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> route<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _route <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> _route<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                children<span class="token punctuation">:</span> <span class="token function">formatRoutes</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>meta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            route<span class="token punctuation">.</span>meta
                <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\{/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\}/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> data <span class="token operator">=</span> m
                        <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\&quot;|\'/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> k <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> v <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            _route <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> _route<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                meta<span class="token punctuation">:</span> obj
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>redirect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _route <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> _route<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                redirect<span class="token punctuation">:</span> route<span class="token punctuation">.</span>redirect
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        _routes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_route<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> _routes<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * é€’å½’æ‰¾é¦–é¡µè·¯ç”±è·¯å¾„(å³ä¾§è¾¹æ ç¬¬ä¸€ä¸ªçš„é¡µé¢)
 * @param {Object} route 
 */</span>
<span class="token keyword">function</span> <span class="token function">findRedirectPath</span><span class="token punctuation">(</span><span class="token parameter">route</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> foundRoute<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">find</span> <span class="token operator">=</span> <span class="token parameter">_route</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_route<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">find</span><span class="token punctuation">(</span>_route<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'isSidebarItem'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            foundRoute <span class="token operator">=</span> _route<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">find</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> foundRoute<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 *
 * ç»„è£…æ‰€æœ‰è·¯ç”± å¹¶æŒ‚è½½å®Œæ•´çš„è·¯ç”±
 * @export
 * @returns
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">assembleRoutes</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// é‡ç½®è·¯ç”±</span>
    <span class="token function">resetRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å…ˆç»„è£…é™æ€è·¯ç”± ä¿è¯ç™»å½•é¡µå¯ä»¥ä½¿ç”¨</span>
    Router<span class="token punctuation">.</span>options<span class="token punctuation">.</span>routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>StaticRoutesMap<span class="token punctuation">]</span><span class="token punctuation">;</span>
    Router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>StaticRoutesMap<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœæ²¡æœ‰tokenåˆ™ä¸è¯·æ±‚è·¯ç”±</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        api<span class="token punctuation">.</span><span class="token function">getRoutes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            token<span class="token punctuation">:</span> Store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>token
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> requestedRoute <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">// æ ¼å¼åŒ–åç«¯è·¯ç”±</span>
                requestedRoute <span class="token operator">=</span> <span class="token function">formatRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>requestedRoute<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è·å–ä¾§è¾¹æ ç¬¬ä¸€è·¯ç”±ä½œä¸ºé¦–é¡µçš„è·¯å¾„</span>
                <span class="token keyword">let</span> redirectPath <span class="token operator">=</span> <span class="token function">findRedirectPath</span><span class="token punctuation">(</span>requestedRoute<span class="token punctuation">)</span><span class="token punctuation">.</span>path<span class="token punctuation">;</span>
                <span class="token comment">// è®¾ç½®è·¯ç”±çš„redirectï¼Œä½¿é¡µé¢ç™»å½•åé¦–å…ˆè·³åˆ°è¯¥é¡µé¢</span>
                requestedRoute<span class="token punctuation">.</span>redirect <span class="token operator">=</span> redirectPath<span class="token punctuation">;</span>
                <span class="token comment">// ä¾§è¾¹æ éœ€è¦ç”¨åˆ°optionsé‡Œæ•°æ®</span>
                Router<span class="token punctuation">.</span>options<span class="token punctuation">.</span>routes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>requestedRoute<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// åŠ¨æ€æ·»åŠ æ ¼å¼åŒ–åçš„åç«¯è·¯ç”±</span>
                <span class="token comment">// 404é¡µé¢ä¸èƒ½å†™åœ¨é™æ€è·¯ç”±é‡Œå¦åˆ™ä¼šä¸€ç›´æ˜¾ç¤º404é¡µé¢</span>
                Router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>requestedRoute<span class="token punctuation">,</span> NotFoundRoute<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_HOME_PAGE'</span><span class="token punctuation">,</span> redirectPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// æŒ‚è½½å®Œè·¯ç”±åï¼Œè°ƒç”¨callback</span>
                callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// æ²¡æœ‰æƒé™æ—¶åªæŒ‚è½½404é¡µé¢</span>
                Router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>NotFoundRoute<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br></div></div><p>é¡µé¢ä¸€åŠ è½½ï¼Œå°±è°ƒç”¨ <code>assembleRoutes</code> è·å–è¯¥ç”¨æˆ·æ‰€èƒ½è®¿é—®çš„è·¯ç”±ï¼Œæ‰€ä»¥å¦‚æœåˆ·æ–°é¡µé¢å¯èƒ½ä¼šé‡å¤æ·»åŠ è·¯ç”±ï¼Œè¿™é‡Œæœ‰ä¸ªhackæ–¹æ³• <code>resetRouter</code> é‡ç½®è·¯ç”±ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>mport Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">createRouter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">resetRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newRouter <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    router<span class="token punctuation">.</span>matcher <span class="token operator">=</span> newRouter<span class="token punctuation">.</span>matcher<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="9"><li>æŒ‰é’®æƒé™ï¼Œå¤§æ¦‚æ€è·¯æ˜¯ï¼Œåç«¯è¿”å›ç”¨æˆ·æ‰€èƒ½è®¿é—®é¡µé¢æŒ‰é’®çš„idæ•°ç»„(æ¯ä¸ªæŒ‰é’®idéƒ½æ˜¯å”¯ä¸€çš„), é€šè¿‡ç¼–å†™å…¬å…±çš„æŒ‰é’®ç»„ä»¶ï¼Œå¯¹æ¯ä¸ªæŒ‰é’®çš„å‚æ•°è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœä¸ç¬¦åˆæ•°ç»„é‡Œçš„idåˆ™éšè—è‡ªèº«ã€‚</li></ol> <p>10.vueä½¿ç”¨vue-echartsæœ‰äº›éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œvue-echartsä½¿ç”¨é¥¼å›¾ã€æŸ±çŠ¶å›¾ç­‰æ˜¯æŒ‰éœ€å¼•å…¥çš„</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> ECharts <span class="token keyword">from</span> <span class="token string">&quot;vue-echarts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;echarts/lib/chart/pie&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;echarts/lib/chart/bar&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;echarts/lib/component/tooltip&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;echarts/lib/component/legendScroll&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;echarts/lib/component/legend&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>11.vueä½¿ç”¨vue-echartsåˆ¶ä½œåœ°å›¾ï¼Œéœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹æ¯”å¦‚<a href="http://datav.aliyun.com/tools/atlas/#&amp;lat=33.521903996156105&amp;lng=104.29849999999999&amp;zoom=4" target="_blank" rel="noopener noreferrer">é«˜å¾·åœ°å›¾çš„JSON<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ–‡ä»¶</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Foshan<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ECharts</span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>map1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> ECharts <span class="token keyword">from</span> <span class="token string">'vue-echarts'</span>
    <span class="token keyword">import</span> <span class="token string">'echarts/lib/chart/effectScatter'</span>
    <span class="token keyword">import</span> <span class="token string">'echarts/lib/chart/map'</span>
    <span class="token keyword">import</span> <span class="token string">'echarts/lib/component/geo'</span>
    <span class="token keyword">import</span> <span class="token string">'echarts/lib/component/tooltip'</span>
    
    <span class="token comment">// åœ°å›¾çš„JSONæ–‡ä»¶</span>
    <span class="token keyword">import</span> foshan <span class="token keyword">from</span> <span class="token string">'@/assets/js/foshan_ali_full.js'</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;Foshan&quot;</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                map1<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ³¨æ„ éœ€è¦æ³¨å†Œåœ°å›¾</span>
            ECharts<span class="token punctuation">.</span><span class="token function">registerMap</span><span class="token punctuation">(</span><span class="token string">'foshan'</span><span class="token punctuation">,</span> foshan<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>area<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>map1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>mapInit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> virtualData <span class="token operator">=</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'å—æµ·åŒº'</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'æš‚æ— æ•°æ®'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'ä¸‰æ°´åŒº'</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'æš‚æ— æ•°æ®'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'ç¦…åŸåŒº'</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'æš‚æ— æ•°æ®'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'é¡ºå¾·åŒº'</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'æš‚æ— æ•°æ®'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'é«˜æ˜åŒº'</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'æš‚æ— æ•°æ®'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>map1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>mapInit</span><span class="token punctuation">(</span>virtualData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">mapInit</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// console.log(foshan);</span>
                <span class="token keyword">let</span> _region <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                foshan<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    _region<span class="token punctuation">[</span>res<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>centroid<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// console.log(_region);</span>
                <span class="token keyword">let</span> <span class="token function-variable function">convertData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">let</span> geoCoord <span class="token operator">=</span> _region<span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>geoCoord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                                <span class="token comment">/*ç»„è£…æ•°æ®ï¼Œåœ¨ä¸‹é¢formatterä½¿ç”¨*/</span>
                                item<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                itemName<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    tooltip<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        trigger<span class="token punctuation">:</span> <span class="token string">'item'</span><span class="token punctuation">,</span>
                        <span class="token function">formatter</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">let</span> <span class="token punctuation">{</span> item<span class="token punctuation">,</span> itemName <span class="token punctuation">}</span> <span class="token operator">=</span> params<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
                            <span class="token keyword">let</span> tipHtml <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;&lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">;</span>
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>item<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            tipHtml <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>itemName<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            tipHtml <span class="token operator">+=</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            <span class="token keyword">return</span> tipHtml
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    geo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        map<span class="token punctuation">:</span> <span class="token string">'foshan'</span><span class="token punctuation">,</span>
                        label<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            emphasis<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                show<span class="token punctuation">:</span> <span class="token boolean">false</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        roam<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        regions<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                            <span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'ä¸‰æ°´åŒº'</span><span class="token punctuation">,</span>
                                itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                    areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(125,156,54)'</span><span class="token punctuation">,</span>
                                    color<span class="token punctuation">:</span> <span class="token string">'white'</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'å—æµ·åŒº'</span><span class="token punctuation">,</span>
                                itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                    areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(222,178,64)'</span><span class="token punctuation">,</span>
                                    color<span class="token punctuation">:</span> <span class="token string">'white'</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'ç¦…åŸåŒº'</span><span class="token punctuation">,</span>
                                itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                    areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(197,102,47)'</span><span class="token punctuation">,</span>
                                    color<span class="token punctuation">:</span> <span class="token string">'white'</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'é¡ºå¾·åŒº'</span><span class="token punctuation">,</span>
                                itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                    areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(124,24,86)'</span><span class="token punctuation">,</span>
                                    color<span class="token punctuation">:</span> <span class="token string">'white'</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'é«˜æ˜åŒº'</span><span class="token punctuation">,</span>
                                itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                    areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(48,122,122)'</span><span class="token punctuation">,</span>
                                    color<span class="token punctuation">:</span> <span class="token string">'white'</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    series<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                        name<span class="token punctuation">:</span> <span class="token string">'Maptip'</span><span class="token punctuation">,</span>
                        type<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
                        mapType<span class="token punctuation">:</span> <span class="token string">'foshan'</span><span class="token punctuation">,</span>
                        itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            areaColor<span class="token punctuation">:</span> <span class="token string">'transparent'</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        emphasis<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            label<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                show<span class="token punctuation">:</span> <span class="token boolean">false</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                areaColor<span class="token punctuation">:</span> <span class="token string">'rgb(114,155,240)'</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        data<span class="token punctuation">:</span> <span class="token function">convertData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        name<span class="token punctuation">:</span> <span class="token string">'Tooltip'</span><span class="token punctuation">,</span>
                        type<span class="token punctuation">:</span> <span class="token string">'effectScatter'</span><span class="token punctuation">,</span>
                        coordinateSystem<span class="token punctuation">:</span> <span class="token string">'geo'</span><span class="token punctuation">,</span>
                        data<span class="token punctuation">:</span> <span class="token function">convertData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        showEffectOn<span class="token punctuation">:</span> <span class="token string">'render'</span><span class="token punctuation">,</span>
                        rippleEffect<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            brushType<span class="token punctuation">:</span> <span class="token string">'stroke'</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        hoverAnimation<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        label<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            normal<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                formatter<span class="token punctuation">:</span> <span class="token string">'{b}'</span><span class="token punctuation">,</span>
                                position<span class="token punctuation">:</span> <span class="token string">'right'</span><span class="token punctuation">,</span>
                                show<span class="token punctuation">:</span> <span class="token boolean">true</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        itemStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            normal<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                color<span class="token punctuation">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
                                shadowBlur<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
                                shadowColor<span class="token punctuation">:</span> <span class="token string">'#333'</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            ECharts
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br></div></div><p>12.vueé€šè¿‡<a href="https://elemefe.github.io/vue-amap/#/zh-cn/introduction/install" target="_blank" rel="noopener noreferrer">vue-amap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä½¿ç”¨é«˜å¾·åœ°å›¾, ç”±äºä½¿ç”¨vue-amapï¼Œå¯èƒ½æ²¡æœ‰ç­‰é¡µé¢åŠ è½½å®Œå°±åˆå§‹åŒ–åœ°å›¾ï¼Œè¿™æ—¶å€™å¯èƒ½å°±ä¼šæŠ¥é”™ï¼Œè€Œä¸”å½“é¡µé¢åŒæ—¶ä½¿ç”¨echartå’Œé«˜å¾·åœ°å›¾æ—¶å¯èƒ½ä¼šå¡é¡¿ï¼Œæœ€å¥½çš„è§£å†³æ–¹å¼æ˜¯ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½ã€‚é«˜å¾·åœ°å›¾çš„å¡é¡¿é—®é¢˜éœ€è¦ä½¿ç”¨é«˜å¾·æ­£ç¡®çš„apiè§£å†³ã€‚</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä½¿ç”¨é«˜å¾·åŸç”Ÿapi</span>
        lazyAMapApiLoaderInstance<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// é€šè¿‡æ¥å£è¿”å›åæ ‡å®šä½åœ°ç‚¹</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span><span class="token function">map_index</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// åœ¨lazyAMapApiLoaderInstanceæ–¹æ³•ä¸‹å¯ä»¥è·å–åŸç”Ÿé«˜å¾·åœ°å›¾å®ä¾‹ AMap</span>
                _AMap <span class="token operator">=</span> AMap<span class="token punctuation">;</span>
                map_index <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

                <span class="token comment">// è·å–åœ°å›¾å®ä¾‹</span>
                map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMap<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token string">&quot;amapContainer&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    center<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">AMap<span class="token punctuation">.</span>LngLat</span><span class="token punctuation">(</span>map_index<span class="token punctuation">.</span>lon<span class="token punctuation">,</span> map_index<span class="token punctuation">.</span>lat<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    mapStyle<span class="token punctuation">:</span> <span class="token string">&quot;amap://styles/darkblue&quot;</span><span class="token punctuation">,</span>
                    zoom<span class="token punctuation">:</span> map_index<span class="token punctuation">.</span>zoom<span class="token punctuation">,</span>
                    resizeEnable<span class="token punctuation">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawDistrict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                timeoutTimer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setMarkers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ol start="12"><li><code>keep-alive</code> ç»†ç²’åº¦æ§åˆ¶ï¼Œæ¯”å¦‚åœ¨ç§»åŠ¨ç«¯ï¼Œå¡«å†™è¡¨å•æ—¶ï¼Œåªæƒ³ç¬¬ä¸€æ¬¡è¿›æ¥é¡µé¢æ—¶å¯åŠ¨ç¼“å­˜ï¼Œåªæœ‰åœ¨å›é€€åˆ°ä¸Šä¸€é¡µåˆ™åˆ é™¤ <code>keep-alive</code> çš„ç¼“å­˜ï¼Œè·³è½¬åˆ°å…¶ä»–é¡µé¢å¼•ç”¨ç¼“å­˜ï¼Œè¿™æ—¶éœ€è¦æ‰‹åŠ¨åˆ é™¤ <code>keep-alive</code> (è¿™ä¸ªæ–¹æ³•å¥½åƒæ˜¯vue2.6ç‰ˆèƒ½å®ç°)ï¼›<a href="https://juejin.im/post/5b610da4e51d45195c07720d" target="_blank" rel="noopener noreferrer">Vue å…¨ç«™ç¼“å­˜ä¹‹ keep-alive ï¼š åŠ¨æ€ç§»é™¤ç¼“å­˜<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">&quot;/disclaimer&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//åˆ é™¤keepAliveç¼“å­˜çš„å®ä¾‹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>keepAlive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>parent <span class="token operator">&amp;&amp;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>componentInstance <span class="token operator">&amp;&amp;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span>cache
            <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> key <span class="token operator">=</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>key <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">.</span>Ctor<span class="token punctuation">.</span>cid <span class="token operator">+</span>
                        <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">.</span>tag <span class="token operator">?</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">::</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">:</span>
                            <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span>cache<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span>keys<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>keys<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">var</span> index <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                keys<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">delete</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><ol start="13"><li>ç§»åŠ¨ç«¯ä»å½“å‰é¡µé¢å›é€€åˆ°è·¨åº¦å¾ˆå¤§çš„ä¸Šå±‚é¡µé¢æ—¶ï¼Œä¸ºäº†ä¸å†å†å²è®°å½•ç•™ä¸‹ç—•è¿¹ï¼Œæœ€å¥½ä½¿ç”¨ <code>router.go</code> è¿”å›é¡µé¢ï¼Œä½†æœ‰æ—¶å› ä¸ºä¸šåŠ¡é€»è¾‘ä¸åŒåœºæ™¯ä¸‹è¿”å›çš„é¡µé¢æ•°é‡ä¸åŒï¼Œæ‰€ä»¥éœ€è¦åŠ¨æ€å»è®¡ç®—é¡µé¢æ•°é‡</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// é€šè¿‡å¯¼èˆªå®ˆå«å’Œvuexç»´æŠ¤ä¸€ä¸ªç”±è·¯ç”±nameç»„æˆçš„é¡µé¢æ ˆ</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    collector<span class="token punctuation">.</span><span class="token function">deal</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœæ˜¯ç‚¹å‡»è¿”å›æŒ‰é’®åˆ™ä¸éœ€è¦åœ¨tiersé‡Œæ·»åŠ name</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>isBackBtn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_TIERS'</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä¿®æ”¹isBackBtnæ ‡è®°</span>
    Store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_IS_BACK_BTN'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * headerBar ç»„ä»¶ 
 */</span>
<span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>returnToApp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">+</span> <span class="token string">&quot;?returnIndex=1&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> pageNum<span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>
            tiers
        <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pageNum <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>page<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageNum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'RESET_TIERS'</span><span class="token punctuation">,</span> tiers<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tiers<span class="token punctuation">.</span>length <span class="token operator">-</span> pageNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'DELETE_TIER'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SET_IS_BACK_BTN'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>é¡µé¢é€»è¾‘ï¼š</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeaderBar</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>ä¸Šä¼ æ”¯ä»˜å‡­è¯'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:page</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>backTier<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HeaderBar</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> tiers <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">;</span>
        <span class="token keyword">let</span> zonesIndex <span class="token operator">=</span> tiers<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;zones&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> uploadCertificateIndex <span class="token operator">=</span> tiers<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>zonesIndex <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>backTier <span class="token operator">=</span> uploadCertificateIndex <span class="token operator">-</span> zonesIndex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> passIndex <span class="token operator">=</span> tiers<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;pass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>backTier <span class="token operator">=</span> uploadCertificateIndex <span class="token operator">-</span> passIndex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ç”±äºä¸šåŠ¡åœºæ™¯åœ¨ç‚¹å‡»å¤´éƒ¨ç»„ä»¶è¿”å›æŒ‰é’®è¿›è¡Œé¡µé¢å›é€€ï¼Œæ‰€ä»¥æŠŠæ‰€æœ‰å›é€€é€»è¾‘é€šè¿‡æ¨¡æ‹Ÿç‚¹å‡»è¿”å›æŒ‰é’®è§¦å‘é¡µé¢å›é€€åˆ°æŒ‡å®šé¡µé¢</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/notebook/css/layout/layout.html" class="prev">
          å¸ƒå±€
        </a></span> <span class="next"><a href="/notebook/js/javascript.html">
          ä»€ä¹ˆæ˜¯JavaScript
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.ba99c14d.js" defer></script><script src="/notebook/assets/js/2.35fbb34e.js" defer></script><script src="/notebook/assets/js/28.d12f3f2d.js" defer></script>
  </body>
</html>
