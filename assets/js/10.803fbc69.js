(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{287:function(t,a,r){"use strict";r.r(a);var v=r(38),_=Object(v.a)({},function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"浏览器事件循环-event-loop"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#浏览器事件循环-event-loop","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器事件循环(Event Loop)")]),t._v(" "),r("div",{staticClass:"tip custom-block"},[r("p",[t._v("处理单线程语言JavaScript异步操作的逻辑，叫事件循环。")])]),t._v(" "),r("h3",{attrs:{id:"_1-一些概念"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-一些概念","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 一些概念")]),t._v(" "),r("p",[t._v("在JavaScript中，任务被分为两种，一种叫"),r("strong",[t._v("宏任务（MacroTask）")]),t._v("，一种叫"),r("strong",[t._v("微任务（MicroTask）")]),t._v("。")]),t._v(" "),r("h3",{attrs:{id:"macrotask-宏任务）"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#macrotask-宏任务）","aria-hidden":"true"}},[t._v("#")]),t._v(" MacroTask(宏任务）")]),t._v(" "),r("ul",[r("li",[t._v("script全部代码")]),t._v(" "),r("li",[t._v("setTimeout")]),t._v(" "),r("li",[t._v("setInterval")]),t._v(" "),r("li",[t._v("setImmediate（浏览器暂时不支持，只有IE10支持，具体可见MDN）")]),t._v(" "),r("li",[t._v("I/O、UI Rendering")])]),t._v(" "),r("h3",{attrs:{id:"microtask（微任务）"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#microtask（微任务）","aria-hidden":"true"}},[t._v("#")]),t._v(" MicroTask（微任务）")]),t._v(" "),r("ul",[r("li",[t._v("Process.nextTick（Node独有）")]),t._v(" "),r("li",[t._v("Promise")]),t._v(" "),r("li",[t._v("Object.observe(废弃)")]),t._v(" "),r("li",[t._v("MutationObserver "),r("a",{attrs:{href:"http://javascript.ruanyifeng.com/dom/mutationobserver.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("具体使用方式查看这里"),r("OutboundLink")],1)])]),t._v(" "),r("h3",{attrs:{id:"javascript引擎-举个例子-chrome-v8"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#javascript引擎-举个例子-chrome-v8","aria-hidden":"true"}},[t._v("#")]),t._v(" JavaScript引擎(举个例子: chrome v8)")]),t._v(" "),r("p",[t._v("JavaScript引擎又称JavaScript解释器，是把JavaScript解释为机器码的工具，分别运行在Node和浏览器中。")]),t._v(" "),r("h3",{attrs:{id:"在node和浏览器中，事件循环是不一样的。"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#在node和浏览器中，事件循环是不一样的。","aria-hidden":"true"}},[t._v("#")]),t._v(" 在Node和浏览器中，事件循环是不一样的。")]),t._v(" "),r("p",[t._v("根据上下文的不同，"),r("strong",[t._v("Event loop")]),t._v("也有不同的实现：其中"),r("strong",[t._v("Node")]),t._v("使用了"),r("strong",[t._v("libuv")]),t._v("库来实现"),r("strong",[t._v("Event loop")]),t._v("; 而在浏览器中，html规范定义了"),r("strong",[t._v("Event loop")]),t._v("，具体的实现则交给不同的厂商去完成。")]),t._v(" "),r("h3",{attrs:{id:"异步任务"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#异步任务","aria-hidden":"true"}},[t._v("#")]),t._v(" 异步任务")]),t._v(" "),r("p",[t._v("由于JavaScript是"),r("strong",[t._v("单线程语言")]),t._v("，所以如果出现堵塞情况，页面可能会有很长时间的停滞情况，然而不是因为"),r("strong",[t._v("CPU")]),t._v("算不过来，"),r("strong",[t._v("CPU")]),t._v("反而大部分时间都是空闲的，原因是因为"),r("strong",[t._v("I/O设备")]),t._v("太慢了(例如: AJAX请求、监听的事件) 所以为了防止堵塞把一些一时半会处理不了的任务挂起等待，接着执行下面的代码，这种被挂起等待的代码块称为"),r("strong",[t._v("异步任务")]),t._v("。")]),t._v(" "),r("h3",{attrs:{id:"i-o"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#i-o","aria-hidden":"true"}},[t._v("#")]),t._v(" I/O")]),t._v(" "),r("blockquote",[r("p",[t._v("计算机中配置的外围设备，根据工作方式不同还分为")])]),t._v(" "),r("ul",[r("li",[t._v("人机交互设备 — 键盘、显示器、打印机等")]),t._v(" "),r("li",[t._v("外部存储器 — 磁盘、磁带、光盘")]),t._v(" "),r("li",[t._v("网络通信设备 — 网卡、调制解调器")])]),t._v(" "),r("h3",{attrs:{id:"任务队列-task-queue"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#任务队列-task-queue","aria-hidden":"true"}},[t._v("#")]),t._v(" 任务队列(task queue)")]),t._v(" "),r("p",[r("strong",[t._v("任务队列")]),t._v("可以理解为存储"),r("strong",[t._v("微任务/回调")]),t._v("的队列，I/O设备完成任务后，把"),r("strong",[t._v("微任务/回调")]),t._v("放到"),r("strong",[t._v("任务队列")]),t._v("，然后按照先进先出的顺序把"),r("strong",[t._v("微任务/回调")]),t._v("读到"),r("strong",[t._v("调用栈")]),t._v("。一个事件循环里有很多个来自不同任务源的"),r("strong",[t._v("任务队列")]),t._v("。但是因为浏览器自己调度的关系，不同队列的任务的执行顺序是不确定的。")]),t._v(" "),r("h3",{attrs:{id:"调用栈-call-stack"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#调用栈-call-stack","aria-hidden":"true"}},[t._v("#")]),t._v(" 调用栈(call stack)")]),t._v(" "),r("p",[r("strong",[t._v("调用栈")]),t._v("也可以叫执行栈，JS调用栈采用的是后进先出的规则，当函数将要执行的时候，会被添加到栈的顶部，当执行栈执行完成后，就会从栈顶移出，直到栈内被清空。")]),t._v(" "),r("h3",{attrs:{id:"_2-事件循环的流程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-事件循环的流程","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.事件循环的流程")]),t._v(" "),r("ol",[r("li",[t._v("先MacroTask任务栈取出一个MacroTask。")]),t._v(" "),r("li",[t._v("主线程执行一些同步代码，并把同步任务存进"),r("strong",[t._v("调用栈")]),t._v("，等待主线程执行。调用webAPI,异步任务被挂起，等到I/O设备完成任务后，把"),r("strong",[t._v("微任务/回调")]),t._v("存进"),r("strong",[t._v("任务队列")]),t._v("。")]),t._v(" "),r("li",[t._v("主线程执行完调用栈里的同步任务后(此时调用栈清空)，然后把任务队列里的"),r("strong",[t._v("微任务/回调")]),t._v("读到"),r("strong",[t._v("调用栈")]),t._v("，并一次过执行完所有"),r("strong",[t._v("微任务/回调")]),t._v("。")]),t._v(" "),r("li",[t._v("然后再取一个MacroTask， 然后再来一轮新的循环。")])]),t._v(" "),r("img",{attrs:{src:t.$withBase("/event_loop.png")}})])},[],!1,null,null,null);a.default=_.exports}}]);